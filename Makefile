# –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
BINARY_NAME=minion
BUILD_DIR=bin
CMD_DIR=cmd/minion

# –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é - –ø–æ–∫–∞–∑–∞—Ç—å —Å–ø—Ä–∞–≤–∫—É
help:
	@echo "üçå Minion - –ö–æ–º–∞–Ω–¥—ã —Å–±–æ—Ä–∫–∏:"
	@echo "  build        - –°–æ–±—Ä–∞—Ç—å –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª"
	@echo "  run          - –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ"
	@echo "  fmt          - –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥"
	@echo "  vet          - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–¥ —Å go vet"
	@echo ""
	@echo "üîë –ö–æ–º–∞–Ω–¥—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:"
	@echo "  extend-keys  - –ü—Ä–æ–¥–ª–µ–Ω–∏–µ API –∫–ª—é—á–µ–π"
	@echo "  refresh-menus - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–µ–Ω—é"
	@echo ""
	@echo "üîß –ö–æ–º–∞–Ω–¥—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:"
	@echo "  deps         - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏"

# –°–±–æ—Ä–∫–∞
build:
	@echo "üî® –°–±–æ—Ä–∫–∞ minion..."
	@mkdir -p $(BUILD_DIR)
	@go build -o $(BUILD_DIR)/$(BINARY_NAME) ./$(CMD_DIR)
	@echo "‚úÖ –ì–æ—Ç–æ–≤–æ: $(BUILD_DIR)/$(BINARY_NAME)"


# –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞
fmt:
	@echo "üíÑ –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞..."
	@go fmt ./...

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞
vet:
	@echo "üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞..."
	@go vet ./...

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
deps:
	@echo "üì• –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π..."
	@go mod tidy
	@go mod download

# –ü—Ä–æ–¥–ª–µ–Ω–∏–µ API –∫–ª—é—á–µ–π
extend-keys:
	@echo "üîë –ü—Ä–æ–¥–ª–µ–Ω–∏–µ API –∫–ª—é—á–µ–π..."
	@./$(BUILD_DIR)/$(BINARY_NAME) extend-keys || go run ./$(CMD_DIR) extend-keys

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–µ–Ω—é
refresh-menus:
	@echo "üçΩÔ∏è –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–µ–Ω—é..."
	@./$(BUILD_DIR)/$(BINARY_NAME) refresh-menus || go run ./$(CMD_DIR) refresh-menus